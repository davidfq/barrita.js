/*! barrita.js - v1.3.0 - 2013-12-03
* https://github.com/davidfq/barrita.js
* Copyright (c) 2013 Licensed MIT */
!function(a){a.barrita=function(b,c){var d=this,e={container:'<div class="barrita"></div>',tmpl:'<div class="barrita__bar" role="bar"></div>',trickleRate:2,trickleSpeed:200,max:94,full:100,speed:400,autoStart:!0,hideOnDone:!0},f=null,g=a(b),h="barrita_"+(b.id||(new Date).getTime()),i=null,j=null,k=!0;d.settings={},d.start=function(){this.settings.hideOnDone&&f.show(),this.getStatus()===this.settings.full&&this.set(0),k=!1,f.addClass("barrita_moving"),this.inc(),m()},d.stop=function(){l()},d.set=function(a){l(),this.settings.hideOnDone&&f.show(),o(a,!1)},d.inc=function(a){var b=j;a||(a=Math.random()*this.settings.trickleRate,1>a&&(a=10*a)),j=n(b+a,0,this.settings.max),o(j,!0)},d.done=function(){j=this.settings.full,p(0,!0),this.settings.hideOnDone&&setTimeout(function(){f.hide()},this.settings.speed),l()},d.getStatus=function(){return j},d.isStopped=function(){return k},d.getId=function(){return h};var l=function(){k=!0,f.removeClass("barrita_moving")},m=function(){i=setTimeout(function(){return k||j===d.settings.full?(clearTimeout(i),void 0):(d.inc(),m(),void 0)},d.settings.speed)},n=function(a,b,c){return b>a?b:a>c?c:a},o=function(a,b){j=a,j>=d.settings.full||(a="-"+(100-a)+"%",p(a,b))},p=function(b,c){var e={"margin-left":b};c&&a.extend(e,{transition:"all "+d.settings.trickleSpeed+"ms linear"}),f.find("[role=bar]").css(e)},q=function(){d.settings=a.extend({},e,c),f=a(d.settings.container),f.attr("id",h).html(d.settings.tmpl),g.append(f),d.settings.autoStart?d.start():d.set(0)};q()},a.fn.barrita=function(b){return this.each(function(){var c=a(this);void 0===c.data("barrita")&&c.data("barrita",new a.barrita(this,b))})}}(this.jQuery||this.Zepto);